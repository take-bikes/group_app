<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>çµæœç™ºè¡¨</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/picnic">
    <style>
        body {
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        .label.female {
            background-color: #e91e63;
        }

        .label.tool {
            background-color: #374151;
            /* Dark Gray */
            color: #fbbf24;
            /* Amber */
            border: 2px solid #fbbf24;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>

<body>
    <h1>ğŸ‰ ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ã‘çµæœ</h1>
    {% if message %}
    <div style="background-color: #dff0d8; color: #3c763d; padding: 10px; margin-bottom: 20px; border-radius: 4px;">
        {{ message }}
    </div>
    {% endif %}
    <div style="margin-bottom: 20px;">
        <a href="/" class="button">æˆ»ã£ã¦ã‚„ã‚Šç›´ã™</a>

        <form action="/save_result" method="POST" style="display:inline-block; margin-left: 10px;">
            <input type="hidden" name="schedule_data" value="{{ schedule_json }}">
            <button type="submit" class="success">ä»Šå›ã®å†…å®¹ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«è¨˜éŒ²ã™ã‚‹</button>
        </form>
    </div>

    {% for day in schedule %}
    <div class="card">
        <header>
            <h3>
                {{ day.day }}æ—¥ç›®
                <span style="font-size:0.6em; color:gray; font-weight: normal;">
                    (ä»Šå›é‡è¤‡: {{ day.details.duplicate_count }}çµ„
                    {% if day.details.gender > 0 %}, æ€§åˆ¥é…æ…®: {{ day.details.gender }}{% endif %}
                    {% if day.details.grade > 0 %}, å­¦å¹´è¢«ã‚Š: {{ day.details.grade }}{% endif %}
                    {% if day.details.tool > 0 %}, å·¥å…·ä¿‚é…åˆ†: {{ day.details.tool }}{% endif %}
                    )
                </span>
            </h3>
        </header>
        <table class="primary">
            <thead>
                <tr>
                    <th>ã‚°ãƒ«ãƒ¼ãƒ—å</th>
                    <th>ãƒ¡ãƒ³ãƒãƒ¼</th>
                </tr>
            </thead>
            <tbody>
                {% for group in day.groups %}
                <tr>
                    <td>ã‚°ãƒ«ãƒ¼ãƒ— {{ loop.index }}</td>
                    <td>
                        {% for person in group %}
                        {% set is_female = person.gender|string|upper in ['å¥³', 'F', 'FEMALE', 'WOMAN'] %}
                        <span class="label {{ 'tool' if person.is_tool else ('female' if is_female else '') }}">
                            {{ 'ğŸ”§ ' if person.is_tool else '' }}{{ person.name }}({{ person.grade }})
                        </span>
                        {% endfor %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <br>
    {% endfor %}
</body>

</html>